(this["webpackJsonpreact_redux-airport"]=this["webpackJsonpreact_redux-airport"]||[]).push([[0],{150:function(e,t,a){},151:function(e,t,a){"use strict";a.r(t);var n,r=a(0),c=a.n(r),i=a(22),l=a.n(i),s=(a(82),a(21)),u=a(13),o=function(e){var t=e.children,a=Object(s.g)(),n=new URLSearchParams(a.search),r=n.get("date")||"",i=n.get("query")||"";return c.a.createElement(u.b,{className:"flights-tabs__tab",activeClassName:"flights-tabs__tab_active",isActive:function(){return!!a.pathname.includes(t)},to:"/".concat(t).concat(r||i?"?".concat(n.toString()):"")},t)},f=(a(87),function(){return c.a.createElement("div",{className:"flights-tabs"},c.a.createElement(o,null,"departures"),c.a.createElement(o,null,"arrivals"))}),d=a(29);!function(e){e.ARRIVAL="arrival",e.DEPARTURE="departure"}(n||(n={}));var m,h=a(30),E=a(70),p=a(37);!function(e){e.REQUESTING_DATA="REQUESTING_DATA",e.RECEIVED_DATA="RECEIVED_DATA",e.SET_FILTERED_QUERY="SET_FILTERED_QUERY"}(m||(m={}));var g={filteredQuery:""},D={flights:{arrival:[],departure:[]},direction:null,fetching:!1},v=a(20),_=Object(v.combineReducers)({fetchData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case m.REQUESTING_DATA:return Object(p.a)({},e,{fetching:!0});case m.RECEIVED_DATA:var a=t.flights,n=t.direction,r=t.date,c=new Date(r).getDate();return Object(p.a)({},e,{flights:{arrival:Object(h.a)(a.body.arrival).filter((function(e){var t=new Date(e.timeToStand).getDate();return c===t})).sort((function(e,t){return Date.parse(e.timeToStand)-Date.parse(t.timeToStand)})),departure:Object(h.a)(a.body.departure).filter((function(e){var t=new Date(e.timeDepExpectCalc).getDate();return c===t})).sort((function(e,t){return Date.parse(e.timeDepExpectCalc)-Date.parse(t.timeDepExpectCalc)}))},direction:n,fetching:!1});default:return e}},sortReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case m.SET_FILTERED_QUERY:return Object(p.a)({},e,{filteredQuery:t.filteredQuery});default:return e}}}),b=function(e){return function(e){return e.fetching}(e.fetchData)},y=Object(E.a)([function(e){return function(e){return e.flights}(e.fetchData)},function(e){return function(e){return e.direction}(e.fetchData)},function(e){return function(e){return e.filteredQuery}(e.sortReducer)}],(function(e,t,a){var r=new RegExp(a,"i");return t===n.DEPARTURE?Object(h.a)(e.departure.filter((function(e){return r.test(e.codeShareData[0].codeShare)||r.test(e["airportToID.city_en"])||r.test(e.airline.en.name)}))):t===n.ARRIVAL?Object(h.a)(e.arrival.filter((function(e){return r.test(e.codeShareData[0].codeShare)||r.test(e["airportFromID.city_en"])||r.test(e.airline.en.name)}))):[]})),R=a(12),S=a.n(R),j=a(23),T=function(e){return new Promise((function(t){return setTimeout(t,e)}))},O=function(){var e=Object(j.a)(S.a.mark((function e(t){var a,n;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T(1e3);case 2:return e.next=4,fetch(t);case 4:return a=e.sent,e.next=7,a.json();case 7:return n=e.sent,e.abrupt("return",n);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=Object(j.a)(S.a.mark((function e(t){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",O("".concat("https://api.iev.aero/api/flights/").concat(t)));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N=function(e,t,a){return{type:m.RECEIVED_DATA,flights:e,direction:t,date:a}},A=function(e){return{type:m.SET_FILTERED_QUERY,filteredQuery:e}},I=a(26),L=a.n(I),x=function(e){var t=e.flightId,a=Object(s.g)(),n=a.pathname,r=new URLSearchParams(a.search),i=(new Date).toLocaleDateString().split(".").join("-"),l=r.get("date")||i;return c.a.createElement(u.b,{to:"".concat(n).concat(t,"?dt=").concat(l)},"Flight Details")},C=function(e){var t=e.flight,a=e.fetching;var n=t.term,r=t.status,i=t.airline,l=t.codeShareData,u=t.actual,o="",f="",d="",m=function(e){return new Date(e).toLocaleTimeString([],{hour:"numeric",minute:"2-digit"})};!function(e){return void 0!==e.timeLandCalc}(t)?(o=t.timeDepExpectCalc,d=t["airportToID.city_en"],t.timeTakeofFact&&"DP"===r&&(f=m(t.timeTakeofFact))):(o=t.timeToStand,d=t["airportFromID.city_en"],"LN"===r&&(f=m(u)));var h=m(o),E=Object(s.g)(),p=new URLSearchParams(E.search).get("query")||"",g=!1;if(p){var D=new RegExp(p,"i");g=!(D.test(l[0].codeShare)||D.test(d)||D.test(i.en.name))}return c.a.createElement("tr",{className:L()({"list-leave-active list-leave-to":a||g})},c.a.createElement("td",{className:L()("flights-table__terminal-col",{blue:"D"===n})},c.a.createElement("span",null,n)),c.a.createElement("td",{className:"flights-table__local-time"},h),c.a.createElement("td",{className:"flights-table__destination-col"},d),c.a.createElement("td",{className:"flights-table__status-col"},"".concat(function(e){switch(e){case"ON":return"On time";case"CX":return"Canceled";case"LN":return"Landed";case"CK":return"Check-in";case"FR":return"In flight";case"BD":return"Boarding";case"DP":return"Departed";case"DV":return"Route change";case"GC":return"Gate closed";default:return e}}(r)," ").concat(f)),c.a.createElement("td",{className:"flights-table__airline-col"},i.en.name),c.a.createElement("td",{className:"flights-table__flight-col"},l[0].codeShare),c.a.createElement("td",{className:"flights-table__details-field"},c.a.createElement(x,{flightId:t.ID})))},U=(a(90),Object(d.b)((function(e){return{flights:y(e),fetching:b(e)}}),{loadData:function(e,t){return function(){var a=Object(j.a)(S.a.mark((function a(n){var r;return S.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n({type:m.REQUESTING_DATA}),a.next=3,w(e);case 3:r=a.sent,n(N(r,t,e));case 5:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()}})((function(e){var t=e.flights,a=e.fetching,i=e.loadData,l=Object(s.g)(),u=Object(s.h)(),o="arrivals"===u.direction?n.ARRIVAL:"departures"===u.direction?n.DEPARTURE:null,f=new URLSearchParams(l.search),d=(new Date).toLocaleDateString().split(".").join("-"),m=(f.get("date")||d).split("-").reverse().join("-");Object(r.useEffect)((function(){console.log("reload data from:",o,", date:",m),i(m,o)}),[o,m]);var h=["Terminal","Local time","Destination","Status","Airline","Flight"].map((function(e,t){return c.a.createElement("th",{key:t},e)}));return 0!==t.length?c.a.createElement("table",{className:"flights-table"},c.a.createElement("thead",null,c.a.createElement("tr",null,h)),c.a.createElement("tbody",null,t.map((function(e){return c.a.createElement(C,{key:e.ID,flight:e,fetching:a})})))):c.a.createElement("div",{className:"nothing-found"},a?c.a.createElement("span",null,"Loading"):c.a.createElement("span",null,"No flights"))}))),P=a(45),k=function(e){var t=e.setDateParams,a=e.calendarDate,n=e.date,r=e.children,i=e.selectedDate.toLocaleDateString()===n.toLocaleDateString();return c.a.createElement("div",{className:L()("flights-dates__day",{"flights-dates__day_active":i}),onClick:function(){return t(n)}},c.a.createElement("span",null,a(n)),r)},Q=a(71),F=a.n(Q);a(91),a(92);function V(e){return e?new Date(e.split("-").reverse().join("-")):new Date}function G(e){return e.toLocaleDateString().split(".").join("-")}function q(e){return e.toLocaleDateString([],{month:"numeric",day:"numeric"}).replace(".","/")}var Y=function(){var e=Object(s.g)(),t=Object(s.f)(),a=new URLSearchParams(e.search),n=Object(r.useState)(V(a.get("date"))),i=Object(P.a)(n,2),l=i[0],u=i[1],o=function(e){u(V(G(e)))},f=function(e){var t=new Date;return t.setDate(t.getDate()+e),t};return Object(r.useEffect)((function(){var e=G(l);a.set("date",e),t.push({search:a.toString()})}),[l]),console.log(l),c.a.createElement("div",{className:"flights-dates__container"},c.a.createElement(F.a,{selected:l,onChange:function(e){return u(e)},customInput:c.a.createElement("div",{className:"flights-calendar__container"},c.a.createElement("div",{className:"flights-calendar__datepicker"},c.a.createElement("input",{type:"text",readOnly:!0,className:"flights-calendar__input",value:q(l)})))}),c.a.createElement("div",{className:"flights-dates__list"},c.a.createElement(k,{selectedDate:l,calendarDate:q,setDateParams:o,date:f(-1)},"Yesterday"),c.a.createElement(k,{selectedDate:l,calendarDate:q,setDateParams:o,date:f(0)},"Today"),c.a.createElement(k,{selectedDate:l,calendarDate:q,setDateParams:o,date:f(1)},"Tomorrow")))},B=(a(150),Object(d.b)(null,{setFilteredQuery:function(e){return function(){var t=Object(j.a)(S.a.mark((function t(a){return S.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,T(1e3);case 2:a(A(e));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}})((function(e){var t=e.setFilteredQuery,a=Object(s.f)(),n=Object(s.g)(),i=new URLSearchParams(n.search),l=i.get("query")||"";Object(r.useEffect)((function(){t(l)}),[l]);var u=Object(r.useState)(l),o=Object(P.a)(u,2),f=o[0],d=o[1],m=function(){var e;(e=f)?i.set("query",e):i.delete("query"),a.push({search:i.toString()})};return c.a.createElement("div",{className:"flights__search-field search-field"},c.a.createElement("h2",{className:"search-field__title"},"SEARCH FLIGHT"),c.a.createElement("div",{className:"search-field__search-line"},c.a.createElement("input",{className:"search-field__input",type:"text",placeholder:"Airline, destination or flight #",value:f,onChange:function(e){var t=e.target.value;d(t)},onKeyDown:function(e){"Enter"===e.key&&m()}}),c.a.createElement("button",{className:"search-field__button",onClick:m},"Search")))}))),H=function(){return c.a.createElement("div",{className:"flights__container"},c.a.createElement(B,null),c.a.createElement(f,null),c.a.createElement(Y,null),c.a.createElement(U,null))},J=a(75),K=a(76),M=Object(v.createStore)(_,Object(K.composeWithDevTools)(Object(v.applyMiddleware)(J.a)));l.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(d.a,{store:M},c.a.createElement(u.a,null,c.a.createElement(s.c,null,c.a.createElement(s.a,{exact:!0,path:"/:direction",component:H}))))),document.getElementById("root"))},77:function(e,t,a){e.exports=a(151)},82:function(e,t,a){},87:function(e,t,a){},90:function(e,t,a){},92:function(e,t,a){}},[[77,1,2]]]);
//# sourceMappingURL=main.1563cc96.chunk.js.map